
"use strict"




const utils     = require('pdir/commons/utils')
const constants = require('pdir/commons/constants')





const partitionFiles = (emitter, args, file) => {

	const handledExtensions = Array.prototype
		.concat.apply([ ], args.extensions)
		.filter(extension => {
			return extension !== constants.extensions.wildcard
		})

	args.extensions.forEach((extensionGroup, ith) => {

		const fileExtension   = utils.fs.extension(file)

		const isGroupMatch    = utils.array.isIn(fileExtension, extensionGroup)

		const isWildcardMatch =
			utils.array.isIn(constants.extensions.wildcard, extensionGroup) &&
			!utils.array.isIn(fileExtension, handledExtensions)

		if (isGroupMatch || isWildcardMatch) {

			emitter.emit(constants.events.partitioned, {
				grouping: ith,
				fpath: file
			})

		}

	})

}





module.exports = partitionFiles
